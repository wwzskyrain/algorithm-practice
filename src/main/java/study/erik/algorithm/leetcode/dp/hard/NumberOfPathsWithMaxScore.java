/**
 * Alipay.com Inc.
 * Copyright (c) 2004-2023 All Rights Reserved.
 */
package study.erik.algorithm.leetcode.dp.hard;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;
import org.junit.runners.Parameterized.Parameter;
import org.junit.runners.Parameterized.Parameters;
import study.erik.algorithm.util.LetCodeCommit;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.List;

/**
 * @author yueyi
 * @version : NumberOfPathsWithMaxScore.java, v 0.1 2023年04月16日 08:33 yueyi Exp $
 */
@RunWith(Parameterized.class)
public class NumberOfPathsWithMaxScore {

    @LetCodeCommit(title = "1301. Number of Paths with Max Score",
    selfRemark = "有一个dp题目，不难的很，聊以充作今天的hard")
    public int[] pathsWithMaxScore(List<String> board) {
        long MOD = 1000000007;
        int n = board.get(0).length();
        long[][][] dp = new long[2][n][2];
        for (int i = 0; i < board.size(); i++) {
            int curLine = i % 2;
            int lastLine = 1 - curLine;
            String s = board.get(i);
            char[] chars = s.toCharArray();
            for (int j = 0; j < n; j++) {
                char c = chars[j];
                if (c == 'E') {
                    dp[curLine][j][0] = 0;
                    dp[curLine][j][1] = 1;
                    continue;
                }
                if (c == 'X') {
                    dp[curLine][j][0] = 0;
                    dp[curLine][j][1] = 0;
                    continue;
                }
                long up = dp[lastLine][j][0];
                long left = j > 0 ? dp[curLine][j - 1][0] : 0;
                long upLeft = (j > 0) ? dp[lastLine][j - 1][0] : 0;
                // 这些大于2的变量都可以用数组
                long upP = dp[lastLine][j][1];
                long leftP = j > 0 ? dp[curLine][j - 1][1] : 0;
                long upLeftP = (j > 0) ? dp[lastLine][j - 1][1] : 0;
                List<long[]> list = new ArrayList<>();
                if (upP > 0) {
                    list.add(new long[] {up, upP});
                }
                if (leftP > 0) {
                    list.add(new long[] {left, leftP});
                }
                if (upLeftP > 0) {
                    list.add(new long[] {upLeft, upLeftP});
                }
                list.sort(Comparator.comparing(a -> ((long[]) a)[0]).reversed());
                if (list.size() == 0) {
                    continue;
                }
                long[] first = list.get(0);
                dp[curLine][j][0] = first[0];
                dp[curLine][j][1] = first[1];
                for (int k = 1; k < list.size(); k++) {
                    if (list.get(k)[0] == first[0]) {
                        dp[curLine][j][1] = (list.get(k)[1] + dp[curLine][j][1]) % MOD;
                        continue;
                    }
                    break;
                }
                if (c != 'S') {
                    dp[curLine][j][0] += (c - '0');
                }
            }
            dp[lastLine] = new long[n][2];
        }
        int lastLine = (board.size() - 1) % 2;
        return new int[] {(int) (dp[lastLine][n - 1][0] % MOD), (int) dp[lastLine][n - 1][1]};
    }

    @Parameter
    public List<String> board;

    @Parameters
    public static Object[][] data() {
        return new Object[][] {
                {Arrays.asList("E23", "2X2", "12S")},
                {Arrays.asList("E12", "1X1", "21S")},
                {Arrays.asList("E11", "XXX", "11S")},
                {Arrays.asList("E999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
                        "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999S")}
        };
    }

    @Test
    public void test_() {
        System.out.println(Arrays.toString(pathsWithMaxScore(board)));
    }

}